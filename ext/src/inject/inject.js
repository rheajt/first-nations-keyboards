const validTypes = ['text', 'textarea'];
const languages = {
  ojibwe: {
    e: '\u1401',
    i: '\u1403',
    o: '\u1405',
    a: '\u140A',
    ii: '\u140E',
    oo: '\u1412',
    aa: '\u1417',
    be: '\u142F',
    bi: '\u1431',
    bo: '\u1433',
    ba: '\u1438',
    bii: '\u143C',
    boo: '\u1440',
    baa: '\u1444',
    b: '\u1449',
    pe: '\u142F',
    pi: '\u1431',
    po: '\u1433',
    pa: '\u1438',
    pii: '\u143C',
    poo: '\u1440',
    paa: '\u1444',
    p: '\u1449',
    de: '\u144C',
    di: '\u144E',
    do: '\u1450',
    da: '\u1455',
    dii: '\u1459',
    doo: '\u145D',
    daa: '\u1461',
    d: '\u14BC',
    te: '\u144C',
    ti: '\u144E',
    to: '\u1450',
    ta: '\u1455',
    tii: '\u1459',
    too: '\u145D',
    taa: '\u1461',
    t: '\u14BC',
    ge: '\u146B',
    gi: '\u146D',
    go: '\u1484',
    ga: '\u1483',
    gii: '\u1476',
    goo: '\u147A',
    gaa: '\u147E',
    g: '\u1483',
    k: '\u1483',
    ke: '\u146B',
    ki: '\u146D',
    ko: '\u1484',
    ka: '\u1483',
    kii: '\u1476',
    koo: '\u147A',
    kaa: '\u147E',
    j: '\u14A1',
    je: '\u1489',
    ji: '\u148B',
    jo: '\u148D',
    ja: '\u1490',
    jii: '\u1494',
    joo: '\u1498',
    jaa: '\u149C',
    ch: '\u14A1',
    che: '\u146B',
    chi: '\u146D',
    cho: '\u1484',
    cha: '\u1483',
    chii: '\u1476',
    choo: '\u147A',
    chaa: '\u147E',
    ne: '\u14C0',
    ni: '\u14C2',
    no: '\u14C4',
    na: '\u14C7',
    nii: '\u1427\u14C2',
    noo: '\u1427\u14C4',
    naa: '\u14CB',
    me: '\u14A3',
    mi: '\u14A5',
    mo: '\u14A7',
    ma: '\u14AA',
    mii: '\u14AE',
    moo: '\u14B2',
    maa: '\u14B6',
    se: '\u14ED',
    si: '\u14EF',
    so: '\u14F1',
    sa: '\u14F4',
    sii: '\u14F8',
    soo: '\u14FC',
    saa: '\u1500',
    ze: '\u14ED',
    zi: '\u14EF',
    zo: '\u14F1',
    za: '\u14F4',
    zii: '\u14F8',
    zoo: '\u14FC',
    zaa: '\u1500',
    she: '\u1510',
    shi: '\u1511',
    sho: '\u1513',
    sha: '\u1515',
    shii: '\u1519',
    shoo: '\u151D',
    shaa: '\u1521',
    sh: '\u1525',
    ye: '\u1526',
    yi: '\u1528',
    yo: '\u152A',
    ya: '\u152D',
    yii: '\u1531',
    yoo: '\u1535',
    yaa: '\u1539',
    y: '\u153E',
    le: '\u14D3',
    li: '\u14D5',
    lo: '\u14D7',
    la: '\u14DA',
    lii: '\u14DE',
    loo: '\u14E2',
    laa: '\u14E6',
    l: '\u14EA',
    we: '\u140C',
    wi: '\u140E',
    wo: '\u1412',
    wa: '\u1417',
    wii: '\u1410',
    woo: '\u1414',
    waa: '\u1419',
    w: '\u1424',
    ve: '\u1555',
    vi: '\u1553',
    vo: '\u1557',
    va: '\u155A',
    v: '\u155D',
    vii: '\u1427\u1553',
    voo: '\u1427\u1557',
    vaa: '\u1427\u155A',
  },
};
chrome.extension.sendMessage('hello', function(response) {
  var readyStateCheckInterval = setInterval(function() {
    if (document.readyState === 'complete') {
      clearInterval(readyStateCheckInterval);
      console.log('**injected**');

      let active = true;
      // chrome.storage.sync.get(['active'], function(result) {
      //   active = !!result.active;
      // });

      document.addEventListener('keyup', ({ keyCode, target, ...evt }) => {
        if (active && !validTypes.includes(target.type)) {
          return;
        }
        const keyHit = String.fromCharCode(keyCode).toLowerCase();
        const calced = languages['ojibwe'][keyHit];
        if (!calced) return;
        target.value += languages['ojibwe'][keyHit];
      });
    }
  }, 10);
});
